<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎯 줄임말 테스트</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family:'Segoe UI', Arial, sans-serif;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    min-height:100vh;
    background:linear-gradient(135deg,#e0eafc,#cfdef3);
    padding:20px;
}
.container {
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 6px 20px rgba(0,0,0,0.15);
    text-align:center;
    width:100%;
    max-width:420px;
}
h2,h3 { color:#333; margin-bottom:12px; font-weight:600; }
input, button { font-size:14px; }
input {
    width:100%;
    padding:8px;
    margin:6px 0;
    border:1px solid #ddd;
    border-radius:6px;
}
button {
    padding:8px 16px;
    margin:6px 3px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    background:linear-gradient(45deg,#4CAF50,#66BB6A);
    color:#fff;
    min-width:90px;
}
button:hover { background:linear-gradient(45deg,#45a049,#5cb85c); }
.radio-group { display:flex; flex-wrap:wrap; justify-content:center; gap:12px; margin:12px 0; }
.radio-group label { font-size:13px; color:#555; }
#loginSection,#testSection,#resultSection,#addQuestionSection,#graphSection { display:none; }
#question { margin:12px 0; font-weight:500; color:#333; word-break:break-word; }
canvas { max-width:100%; height:200px; margin-top:12px; border-radius:6px; background:#fff; padding:6px; }
.table-container { max-width:100%; overflow-x:auto; margin-top:12px; }
table { width:100%; border-collapse:collapse; font-size:13px; text-align:center; }
th,td { border:1px solid #ddd; padding:6px; }
th { background:#f5f5f5; }
.no-data { margin-top:12px; color:#555; }
</style>
</head>
<body>
<div class="container">
<h2>🎯 줄임말 테스트</h2>

<div id="loginSection">
<h3>👤 관리자 로그인</h3>
<input type="text" id="adminId" placeholder="아이디 입력">
<input type="password" id="adminPassword" placeholder="비밀번호 입력">
<button onclick="adminLogin()">🔑 로그인</button>
</div>

<form id="infoForm" onsubmit="startTest(event)">
<h3>📝 학생 정보 입력</h3>
<input type="text" id="name" placeholder="이름을 입력하세요" required>
<button type="submit">▶ 테스트 시작</button>
<button type="button" onclick="showAdminLogin()">👤 관리자 로그인</button>
</form>

<div id="testSection">
<h3>📚 줄임말 테스트</h3>
<p id="question"></p>
<div class="radio-group">
<label>✅ <input type="radio" name="answer" value="yes"> 씁니다</label>
<label>❌ <input type="radio" name="answer" value="no"> 안씁니다</label>
</div>
<button onclick="nextQuestion()">➡ 다음</button>
<button onclick="goBack('testSection')">🔙 뒤로 가기</button>
</div>

<div id="resultSection">
<h3>🏆 테스트 결과</h3>
<p id="result"></p>
<canvas id="personalScoreChart"></canvas>
<button onclick="goBack('resultSection')">🔙 뒤로 가기</button>
</div>

<div id="addQuestionSection">
<h3>➕ 질문 추가</h3>
<input type="text" id="newQuestion" placeholder="줄임말 입력">
<button onclick="addQuestion()">✅ 질문 추가</button>
<button onclick="showGraph()">📊 그래프 보기</button>
<button onclick="showTable()">🗂 학생 응답 보기</button>
<button onclick="resetStudentData()">🧹 학생 데이터 초기화</button>
<div id="responseTable" class="table-container"></div>
</div>

<div id="graphSection">
<h3>📈 전체 학생 점수</h3>
<div id="noDataMessage" class="no-data">학생 데이터가 없습니다.</div>
<canvas id="scoreChart"></canvas>
<button onclick="goBack('graphSection')">🔙 뒤로 가기</button>
</div>
</div>

<script>
let questions = JSON.parse(localStorage.getItem('questions')) || [
{ text:"생파", correct:"no"},{ text:"생선", correct:"no"},
{ text:"영통", correct:"no"},{ text:"카톡", correct:"no"},
{ text:"ㅇㅇ", correct:"no"},{ text:"ㅇㅈ", correct:"no"},{ text:"ㅇㅋ", correct:"no"}];
let currentQuestion=0,score=0,studentData=JSON.parse(localStorage.getItem('studentData'))||[],currentStudent={},currentResponses=[],chartInstance=null,personalChartInstance=null;

window.onload=()=>{document.getElementById('infoForm').style.display='block';};
function showAdminLogin(){document.getElementById('infoForm').style.display='none';document.getElementById('loginSection').style.display='block';}
function adminLogin(){const id=document.getElementById('adminId').value,password=document.getElementById('adminPassword').value;if(id==="2541"&&password==="2541"){document.getElementById('loginSection').style.display='none';document.getElementById('addQuestionSection').style.display='block';showTable();}else alert('아이디 또는 비밀번호가 잘못되었습니다.');}
function goBack(section){document.getElementById(section).style.display='none';if(section==='testSection'||section==='resultSection'){document.getElementById('infoForm').style.display='block';}else if(section==='graphSection'){document.getElementById('addQuestionSection').style.display='block';showTable();}}
function startTest(e){e.preventDefault();const name=document.getElementById('name').value.trim();if(!name){alert('이름을 입력해주세요!');return;}currentStudent={name};currentResponses=[];score=0;currentQuestion=0;document.getElementById('infoForm').style.display='none';document.getElementById('testSection').style.display='block';loadQuestion();}
function loadQuestion(){if(currentQuestion<questions.length){document.getElementById('question').textContent=`문제 ${currentQuestion+1}: "${questions[currentQuestion].text}"을(를) 사용합니까?`;document.querySelectorAll('input[name="answer"]').forEach(r=>r.checked=false);}else showResult();}
function nextQuestion(){const selected=document.querySelector('input[name="answer"]:checked');if(!selected){alert('답을 선택해주세요!');return;}currentResponses.push(selected.value);if(selected.value===questions[currentQuestion].correct)score++;currentQuestion++;loadQuestion();}
function showResult(){document.getElementById('testSection').style.display='none';document.getElementById('resultSection').style.display='block';const percentage=Math.round(score/questions.length*100);document.getElementById('result').textContent=`🎉 ${currentStudent.name}님의 점수: ${score}/${questions.length} (${percentage}점)`;studentData.push({label:currentStudent.name,score:percentage,responses:currentResponses});localStorage.setItem('studentData',JSON.stringify(studentData));if(personalChartInstance)personalChartInstance.destroy();const ctx=document.getElementById('personalScoreChart').getContext('2d');personalChartInstance=new Chart(ctx,{type:'bar',data:{labels:[currentStudent.name],datasets:[{label:'내 점수 (1-100)',data:[percentage],backgroundColor:'rgba(75,192,192,0.7)',borderColor:'rgba(75,192,192,1)',borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,max:100}}}});}
function addQuestion(){const q=document.getElementById('newQuestion').value.trim();if(!q){alert('줄임말을 입력해주세요!');return;}questions.push({text:q,correct:'no'});localStorage.setItem('questions',JSON.stringify(questions));document.getElementById('newQuestion').value='';alert('✅ 질문이 추가되었습니다!');}
function resetStudentData(){if(!confirm('모든 학생 데이터를 초기화하시겠습니까?'))return;studentData=[];localStorage.removeItem('studentData');if(chartInstance){chartInstance.destroy();chartInstance=null;}document.getElementById('responseTable').innerHTML='';alert('🧹 학생 데이터가 초기화되었습니다.');document.getElementById('addQuestionSection').style.display='block';document.getElementById('graphSection').style.display='none';}
function showTable(){const container=document.getElementById('responseTable');if(studentData.length===0){container.innerHTML='<p class="no-data">학생 데이터가 없습니다.</p>';return;}let table='<table><thead><tr><th>학생</th>';questions.forEach((q,i)=>table+=`<th>문제 ${i+1}</th>`);table+='</tr></thead><tbody>';studentData.forEach(s=>{table+=`<tr><td>${s.label}</td>`;s.responses.forEach(r=>table+=`<td>${r==='yes'?'✅ 씁니다':'❌ 안씁니다'}</td>`);table+='</tr>';});table+='</tbody></table>';container.innerHTML=table;}
function showGraph(){document.getElementById('resultSection').style.display='none';document.getElementById('infoForm').style.display='none';document.getElementById('testSection').style.display='none';document.getElementById('addQuestionSection').style.display='none';document.getElementById('graphSection').style.display='block';const noData=document.getElementById('noDataMessage'),scoreChart=document.getElementById('scoreChart');if(studentData.length===0){noData.style.display='block';scoreChart.style.display='none';return;}noData.style.display='none';scoreChart.style.display='block';if(chartInstance)chartInstance.destroy();const ctx=scoreChart.getContext('2d');chartInstance=new Chart(ctx,{type:'bar',data:{labels:studentData.map(d=>d.label),datasets:[{label:'점수 (1-100)',data:studentData.map(d=>d.score),backgroundColor:'rgba(75,192,192,0.7)',borderColor:'rgba(75,192,192,1)',borderWidth:2,borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,max:100}}}});}
</script>
</body>
</html>
